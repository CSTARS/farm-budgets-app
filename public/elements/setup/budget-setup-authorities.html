<link rel="import" href="budget-setup-authority-editor.html" />

<dom-module id="budget-setup-authorities">
  <template>
    <style>
      :host {
        display: block;
      }
    </style>

    <div id="select">
      <template is="dom-repeat" items="{{authorities}}">
        <div class="panel panel-default">
          <div class="panel-body">
            <a class="btn btn-link" href$="{{item.href}}"><i class="fa fa-pencil"></i></a>
            <span>{{item.label}}</span>
          </div>
        </div>
      </template>
    </div>

    <budget-setup-authority-editor id="editor"></budget-setup-authority-editor>

  </template>
  <script>
    Polymer({
      is: 'budget-setup-authorities',

      ready : function() {
        this.authorities = [];
      },

      set : function() {
        if( !ExpressAuth.user ) return;

        var arr = [];
        for( var i = 0; i < ExpressAuth.user.authorities.length; i++ ) {
          arr.push({
            label : ExpressAuth.user.authorities[i],
            href : '#budget/setup/authorities/'+ExpressAuth.user.authorities[i]
          });
        }
        this.authorities = arr;
      },

      onShow : function(params) {
        this.set();

        if( params.length == 0 ) {
          this.$.select.style.display = 'block';
          this.$.editor.style.display = 'none';
        } else {
          this.$.select.style.display = 'none';
          this.$.editor.style.display = 'block';
          this.$.editor.authority = params[0];
        }
      }
    });
  </script>
</dom-module>
